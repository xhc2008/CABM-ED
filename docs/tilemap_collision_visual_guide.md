# TileSet 碰撞箱设置 - 可视化指南

## 🎯 核心步骤（4步搞定）

### 步骤 1️⃣: 添加物理层
```
位置：TileSet 编辑器底部 → "Setup" 标签
操作：找到 "Physics Layers" → 点击 + 号
结果：出现 "Physics Layer 0"
```

### 步骤 2️⃣: 选择 Tile
```
位置：底部 → "Select" 标签
操作：在中间的图片预览区域点击 tile
技巧：Ctrl+点击 可以多选
```

### 步骤 3️⃣: 切换到物理模式
```
位置：底部 → "Physics" 标签
操作：点击切换
重要：这时候工具栏才会出现！
```

### 步骤 4️⃣: 绘制碰撞箱
```
位置：tile 预览区域的上方工具栏
工具：点击矩形图标 🔲
操作：在 tile 上拖拽绘制
```

---

## 🔍 找不到工具？检查清单

### ✅ 检查点 1: 是否添加了物理层？
```
Setup 标签 → Physics Layers → 应该有 "Layer 0"
如果没有，点击 + 添加
```

### ✅ 检查点 2: 是否选中了 Tile？
```
Select 标签 → 点击一个 tile
选中的 tile 会有高亮边框
```

### ✅ 检查点 3: 是否在 Physics 标签？
```
底部标签栏：[Setup] [Select] [Paint] [Physics]
                                        ↑ 要在这里
```

### ✅ 检查点 4: 工具栏的位置
```
工具栏不在侧边栏！
工具栏在 tile 预览图的正上方！

错误位置 ❌: 左侧面板、右侧面板
正确位置 ✅: 中间预览区域的上方
```

---

## 🎨 界面布局说明

```
┌──────────────────────────────────────────────────────┐
│  Godot 编辑器主窗口                                   │
│  ┌────────────────────────────────────────────────┐  │
│  │ 场景树                                          │  │
│  │  └─ TileMapLayer ← 选中这个节点                │  │
│  └────────────────────────────────────────────────┘  │
│  ┌────────────────────────────────────────────────┐  │
│  │ Inspector (检查器)                              │  │
│  │  Tile Set: [点击这个资源打开编辑器]            │  │
│  └────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────┘

点击 TileSet 资源后，底部会展开：

┌──────────────────────────────────────────────────────┐
│ TileSet 编辑器 (底部面板)                             │
├──────────────────────────────────────────────────────┤
│ [Setup] [Select] [Paint] [Physics] [Navigation] ... │ ← 标签栏
├──────────────────────────────────────────────────────┤
│                                                       │
│  左侧面板          中间预览区域          右侧面板    │
│  ┌──────┐         ┌──────────────┐      ┌────────┐  │
│  │Atlas │         │ 🔲 🔺 ✏️ 🗑️  │      │Physics │  │
│  │列表  │         │ ↑ 工具栏     │      │Layer 0 │  │
│  │      │         │              │      │        │  │
│  │- 图集│         │  [Tile预览]  │      │        │  │
│  │  1   │         │              │      │        │  │
│  │      │         │              │      │        │  │
│  └──────┘         └──────────────┘      └────────┘  │
│                                                       │
└──────────────────────────────────────────────────────┘
```

---

## 🛠️ 工具图标说明

在 **Physics 标签** 的 tile 预览区域上方：

| 图标 | 名称 | 功能 | 使用方法 |
|------|------|------|----------|
| 🔲 | 矩形工具 | 创建矩形碰撞箱 | 拖拽绘制 |
| 🔺 | 多边形工具 | 创建多边形碰撞箱 | 点击多个点 |
| ✏️ | 编辑工具 | 编辑现有碰撞形状 | 拖动顶点 |
| 🗑️ | 删除工具 | 删除碰撞形状 | 点击要删除的形状 |

---

## 📝 实战操作流程

### 场景：为墙壁 tile 批量添加碰撞

#### 1. 准备工作
```
1. 打开 scenes/explore_scene.tscn
2. 选中 TileMapLayer 节点
3. 在 Inspector 中点击 Tile Set 资源
4. 底部会打开 TileSet 编辑器
```

#### 2. 添加物理层（只需做一次）
```
1. 点击 "Setup" 标签
2. 找到 "Physics Layers" 部分
3. 点击 + 号
4. 看到 "Physics Layer 0" 就成功了
```

#### 3. 选择所有墙壁 tile
```
1. 点击 "Select" 标签
2. 在 Atlas 预览中，找到墙壁 tile
3. 按住 Ctrl，点击所有墙壁 tile
4. 或者按住 Shift 拖拽框选
```

#### 4. 添加碰撞箱
```
1. 点击 "Physics" 标签
2. 在 tile 预览区域上方，点击矩形工具 🔲
3. 在第一个 tile 上，从左上角拖到右下角
4. 松开鼠标
5. 所有选中的 tile 都会有相同的碰撞箱！
```

#### 5. 验证碰撞箱
```
1. 在 Physics 标签中，应该能看到蓝色/绿色的碰撞形状
2. 运行游戏 (F5)
3. 游戏运行时按 F4 键
4. 会显示所有碰撞箱的轮廓
```

---

## 🚨 常见错误

### ❌ 错误 1: 工具栏是灰色的
**原因**: 没有添加物理层  
**解决**: Setup 标签 → Physics Layers → 点击 +

### ❌ 错误 2: 看不到工具栏
**原因**: 没有选中 tile 或不在 Physics 标签  
**解决**: 
1. Select 标签 → 选中一个 tile
2. Physics 标签 → 工具栏会出现

### ❌ 错误 3: 绘制了但看不到碰撞箱
**原因**: 可能绘制在了 tile 外面  
**解决**: 
1. 确保在 tile 的边界内绘制
2. 碰撞箱应该显示为蓝色或绿色的形状

### ❌ 错误 4: 玩家还是穿墙
**原因**: 碰撞层设置不对  
**解决**: 
1. 选中 TileMapLayer 节点
2. Inspector → Collision → Layer 设为 1
3. 选中 Player 节点
4. Inspector → Collision → Mask 包含 Layer 1

---

## 💡 专业技巧

### 技巧 1: 快速批量设置
```
1. 先把所有墙壁 tile 放在 tileset 图片的同一行
2. 在 Select 标签用 Shift+拖拽 一次性选中整行
3. 切换到 Physics 标签，绘制一次碰撞箱
4. 所有墙壁都有碰撞了！
```

### 技巧 2: 不同类型的碰撞
```
地板 tile: 不添加碰撞（玩家可以走）
墙壁 tile: 完整矩形碰撞（玩家不能穿过）
半高障碍: 部分碰撞（只在一部分区域添加）
```

### 技巧 3: 调试碰撞
```
运行游戏后按 F4 = 显示碰撞形状
运行游戏后按 F3 = 显示帧率等信息
```

### 技巧 4: 保存 TileSet
```
TileSet 会自动保存在场景文件中
如果想复用，可以：
1. 在 Inspector 中右键 TileSet 资源
2. 选择 "Save" 或 "Save As"
3. 保存为 .tres 文件
4. 其他场景可以加载这个文件
```

---

## 🎓 学习资源

### 官方文档
- Godot 4 TileMap 文档: https://docs.godotengine.org/en/stable/tutorials/2d/using_tilemaps.html

### 视频教程（搜索关键词）
- "Godot 4 TileMap tutorial"
- "Godot 4 TileSet collision"
- "Godot 4 TileMapLayer"

### 如果还是找不到工具
1. 确认 Godot 版本是 4.x（不是 3.x）
2. 尝试重启 Godot 编辑器
3. 尝试创建一个新的 TileSet 资源
4. 检查编辑器窗口是否太小，工具栏被隐藏了
5. 尝试调整底部面板的高度（拖动分隔线）
