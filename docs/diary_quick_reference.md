# æ—¥è®°åŠŸèƒ½å¿«é€Ÿå‚è€ƒ

## ç”¨æˆ·ä½¿ç”¨

### å¦‚ä½•æŸ¥çœ‹æ—¥è®°ï¼Ÿ
1. è¿›å…¥**å§å®¤**åœºæ™¯
2. ç‚¹å‡»å·¦ä¸‹è§’çš„**éšè—åˆ¤å®šåŒºåŸŸ**ï¼ˆ80x80åƒç´ ï¼‰
3. åœ¨å¼¹å‡ºçš„èœå•ä¸­ç‚¹å‡» **ğŸ“– æ—¥è®°**
4. ä½¿ç”¨ **â—€ å‰ä¸€å¤©** / **åä¸€å¤© â–¶** åˆ‡æ¢æ—¥æœŸ
5. å‘ä¸Šæ»šåŠ¨æŸ¥çœ‹æ›´æ—©çš„å¯¹è¯
6. ç‚¹å‡» **å…³é—­** é€€å‡º

### æ—¥è®°åœ¨å“ªé‡Œï¼Ÿ
- ä½ç½®ï¼š`user://diary/`
- æ ¼å¼ï¼š`YYYY-MM-DD.jsonl`
- ç¤ºä¾‹ï¼š`2024-01-15.jsonl`

### Windowsç”¨æˆ·æ•°æ®ä½ç½®
```
%APPDATA%\Godot\app_userdata\[é¡¹ç›®å]\diary\
```

## å¼€å‘è€…å‚è€ƒ

### å…³é”®æ–‡ä»¶
| æ–‡ä»¶ | è¯´æ˜ | ç±»å‹ |
|------|------|------|
| `scripts/ai_service.gd` | æ·»åŠ æ—¥è®°ä¿å­˜é€»è¾‘ | ä¿®æ”¹ |
| `scripts/main.gd` | é›†æˆæ—¥è®°åŠŸèƒ½ | ä¿®æ”¹ |
| `scripts/main.tscn` | æ·»åŠ UIèŠ‚ç‚¹ | ä¿®æ”¹ |
| `scripts/diary_viewer.gd` | æ—¥è®°æŸ¥çœ‹å™¨ | æ–°å¢ |
| `scripts/diary_button.gd` | æ—¥è®°æŒ‰é’® | æ–°å¢ |

### å…³é”®å‡½æ•°

#### ä¿å­˜æ—¥è®°
```gdscript
# AIService
func _save_full_conversation_to_diary()
```

#### æ˜¾ç¤ºæ—¥è®°
```gdscript
# DiaryViewer
func show_diary()
func _load_date_content(date_str: String)
func _display_more_messages()
```

#### åœºæ™¯æ§åˆ¶
```gdscript
# Main
func _update_diary_button_visibility()
func _on_diary_button_clicked()
```

### æ•°æ®æ ¼å¼

#### JSONLæ–‡ä»¶æ ¼å¼
```json
{"timestamp":"14:30:25","messages":[{"speaker":"ç”¨æˆ·","content":"ä½ å¥½"},{"speaker":"è§’è‰²","content":"ä½ å¥½ï¼"}]}
{"timestamp":"15:45:10","messages":[{"speaker":"ç”¨æˆ·","content":"ä»Šå¤©å¤©æ°”ä¸é”™"},{"speaker":"è§’è‰²","content":"æ˜¯å•Šï¼Œå¾ˆé€‚åˆå‡ºå»èµ°èµ°"}]}
```

### é…ç½®å‚æ•°

#### DiaryViewer
```gdscript
const MESSAGES_PER_PAGE = 20  # æ¯é¡µæ˜¾ç¤ºçš„æ¶ˆæ¯æ•°
const ANIMATION_DURATION = 0.3  # åŠ¨ç”»æ—¶é•¿
```

#### DiaryButton
```gdscript
const ANIMATION_DURATION = 0.2  # åŠ¨ç”»æ—¶é•¿
```

### ä¿¡å·

#### DiaryButton
```gdscript
signal diary_button_clicked  # æ—¥è®°æŒ‰é’®è¢«ç‚¹å‡»
```

#### DiaryViewer
```gdscript
signal diary_closed  # æ—¥è®°æŸ¥çœ‹å™¨å…³é—­
```

## è°ƒè¯•å‘½ä»¤

### æŸ¥çœ‹æ—¥è®°æ–‡ä»¶ï¼ˆWindowsï¼‰
```cmd
cd %APPDATA%\Godot\app_userdata\[é¡¹ç›®å]\diary
dir
type 2024-01-15.jsonl
```

### æŸ¥çœ‹æ—¥è®°æ–‡ä»¶ï¼ˆLinux/Macï¼‰
```bash
cd ~/.local/share/godot/app_userdata/[é¡¹ç›®å]/diary
ls -la
cat 2024-01-15.jsonl
```

### æ¸…ç©ºæ—¥è®°
```cmd
# Windows
del %APPDATA%\Godot\app_userdata\[é¡¹ç›®å]\diary\*.jsonl

# Linux/Mac
rm ~/.local/share/godot/app_userdata/[é¡¹ç›®å]/diary/*.jsonl
```

## å¸¸è§é—®é¢˜

### Q: æ—¥è®°å…¥å£ä¸å·¥ä½œï¼Ÿ
**A:** ç¡®ä¿ä½ åœ¨**å§å®¤**åœºæ™¯ï¼Œå¹¶ç‚¹å‡»å·¦ä¸‹è§’çš„éšè—åˆ¤å®šåŒºåŸŸï¼ˆ80x80åƒç´ åŒºåŸŸï¼‰ã€‚

### Q: æ—¥è®°æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ
**A:** 
- Windows: `%APPDATA%\Godot\app_userdata\[é¡¹ç›®å]\diary\`
- Linux: `~/.local/share/godot/app_userdata/[é¡¹ç›®å]/diary/`
- Mac: `~/Library/Application Support/Godot/app_userdata/[é¡¹ç›®å]/diary/`

### Q: å¦‚ä½•å¤‡ä»½æ—¥è®°ï¼Ÿ
**A:** å¤åˆ¶æ•´ä¸ª `diary/` æ–‡ä»¶å¤¹å³å¯ã€‚

### Q: æ—¥è®°æ–‡ä»¶ä¼šå ç”¨å¤šå°‘ç©ºé—´ï¼Ÿ
**A:** æ¯æ¬¡å¯¹è¯çº¦1-2KBï¼Œæ¯å¤©10æ¬¡å¯¹è¯çº¦10-20KBï¼Œä¸€å¹´çº¦3-7MBã€‚

### Q: å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘æ—¥è®°å—ï¼Ÿ
**A:** å¯ä»¥ï¼Œä½†è¦ä¿æŒJSONLæ ¼å¼æ­£ç¡®ï¼Œæ¯è¡Œä¸€ä¸ªå®Œæ•´çš„JSONå¯¹è±¡ã€‚

### Q: æ—¥è®°ä¼šå½±å“æ¸¸æˆæ€§èƒ½å—ï¼Ÿ
**A:** ä¸ä¼šï¼Œæ—¥è®°ä½¿ç”¨åˆ†é¡µåŠ è½½ï¼Œåªåœ¨æŸ¥çœ‹æ—¶è¯»å–æ–‡ä»¶ã€‚

## æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| åˆå§‹åŠ è½½æ—¶é—´ | < 100ms |
| åˆ†é¡µåŠ è½½æ—¶é—´ | < 50ms |
| å†…å­˜å ç”¨ | < 5MB |
| æ–‡ä»¶å¤§å°ï¼ˆæ¯å¤©ï¼‰ | 10-20KB |
| æ”¯æŒçš„æœ€å¤§å¯¹è¯æ•° | æ— é™åˆ¶ |

## ç‰ˆæœ¬å†å²

### v1.0 (å½“å‰ç‰ˆæœ¬)
- âœ… å®Œæ•´è®°å½•æ¯å¥å¯¹è¯
- âœ… æŒ‰æ—¥æœŸåˆ†ç±»ä¿å­˜
- âœ… æ—¥è®°æŸ¥çœ‹å™¨ï¼ˆåˆ†é¡µåŠ è½½ï¼‰
- âœ… æ—¥æœŸåˆ‡æ¢åŠŸèƒ½
- âœ… ä»…åœ¨å§å®¤æ˜¾ç¤ºæŒ‰é’®

### æœªæ¥è®¡åˆ’
- ğŸ”² æœç´¢åŠŸèƒ½
- ğŸ”² å¯¼å‡ºåŠŸèƒ½
- ğŸ”² ç»Ÿè®¡åŠŸèƒ½
- ğŸ”² æ ‡ç­¾ç³»ç»Ÿ
- ğŸ”² æƒ…æ„Ÿåˆ†æ

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**: GDScript
- **å¼•æ“**: Godot 4.x
- **å­˜å‚¨æ ¼å¼**: JSONL (JSON Lines)
- **UIæ¡†æ¶**: Godot ControlèŠ‚ç‚¹
- **åŠ¨ç”»**: Godot Tween

## è®¸å¯è¯

ä¸ä¸»é¡¹ç›®ä¿æŒä¸€è‡´ã€‚
