# 探索模式 - 雪狐随从系统

## 功能概述

探索模式现在包含了一个智能雪狐随从和移动摇杆系统。

## 雪狐随从特性

### 智能跟随
- **延迟反应**：雪狐不会立即跟随玩家，有约0.15秒的反应延迟，更加真实
- **保持距离**：当距离超过80像素时才开始跟随
- **防止堵塞**：如果靠玩家太近（<30像素）超过2秒，会主动远离到60像素距离
- **自动传送**：如果距离超过400像素，会自动传送回玩家附近

### 导航系统
- 使用NavigationAgent2D进行路径规划
- 自动绕开障碍物
- 平滑的移动和转向

### 参数调整
在`scripts/explore/snow_fox_companion.gd`中可以调整：
- `follow_speed`: 跟随速度（默认180）
- `min_follow_distance`: 开始跟随的最小距离（默认80）
- `too_close_distance`: 太近的距离阈值（默认30）
- `reaction_delay`: 反应延迟时间（默认0.15秒）

## 虚拟摇杆

### 功能
- 支持触摸屏和鼠标操作
- 位于屏幕左下角
- 半透明设计，不遮挡游戏画面
- 支持死区设置，避免误触

### 使用方式
- **触摸设备**：触摸摇杆区域并拖动
- **鼠标**：点击摇杆并拖动
- **键盘**：WASD键依然可用

### 参数调整
在`scripts/explore/virtual_joystick.gd`中可以调整：
- `joystick_radius`: 摇杆活动半径（默认60）
- `stick_radius`: 摇杆按钮半径（默认25）
- `dead_zone`: 死区大小（默认0.2）

## 文件结构

```
scripts/explore/
├── explore_player.gd          # 玩家控制（支持摇杆）
├── explore_scene.gd           # 场景管理
├── snow_fox_companion.gd      # 雪狐随从AI
└── virtual_joystick.gd        # 虚拟摇杆控制

scenes/
├── explore_scene.tscn         # 主探索场景
├── snow_fox_companion.tscn    # 雪狐场景（可选）
└── virtual_joystick.tscn      # 摇杆场景（可选）

assets/images/explore/
└── SnowFox.png               # 雪狐图片资源
```

## 技术细节

### 玩家控制优先级
1. 摇杆输入（如果有）
2. 键盘输入（WASD）
3. 鼠标朝向（仅在非摇杆模式）

### 随从AI状态
- **跟随模式**：距离适中时跟随玩家
- **等待模式**：距离太近时停止移动
- **远离模式**：靠太近太久时主动远离
- **传送模式**：距离太远时瞬移回来

## 未来改进建议

1. 添加雪狐动画（行走、停止、转向）
2. 添加雪狐互动功能（点击、抚摸）
3. 支持多个随从
4. 添加随从AI个性化设置
5. 摇杆视觉效果优化（渐变、阴影）
